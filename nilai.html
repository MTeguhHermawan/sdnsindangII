<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Nilai Siswa</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial, sans-serif; background:#f4f6f8; margin:0 }
header { background:#1e88e5; color:white; padding:20px; text-align:center }
.container { padding:20px }
input, select, button {
  width:100%; padding:12px; margin-top:10px;
  border-radius:8px; border:1px solid #ccc;
  font-size:16px;
}
button { background:#1e88e5; color:white; border:none }
.card {
  background:white;
  padding:15px;
  margin-top:12px;
  border-radius:10px;
  box-shadow:0 2px 5px rgba(0,0,0,0.1)
}
</style>
</head>

<body>

<header>
<h2>üìä Cek Nilai Siswa</h2>
<a href="index.html" style="color:white;text-decoration:none">‚Üê Kembali</a>
</header>

<div class="container">
  <input id="kode" placeholder="Masukkan Kode Orang Tua">

  <select id="mapel">
    <option value="">-- Pilih Mata Pelajaran --</option>
    <option value="MATEMATIKA">Matematika</option>
    <option value="IPAS">IPAS</option>
    <option value="SBDP">SBDP</option>
    <option value="PKN">PKN</option>
    <option value="BAHASA SUNDA">Bahasa Sunda</option>
    <option value="BAHASA INGGRIS">Bahasa Inggris</option>
  </select>

  <button onclick="cek()">Lihat Nilai</button>

  <div id="hasil"></div>
</div>

<script>
function normalisasiMapel(text) {
  return text
    .split("(")[0]        // ambil sebelum tanda kurung
    .trim()
    .toUpperCase();       // samakan huruf
}

async function cek() {
  const kode = document.getElementById("kode").value.trim();
  const mapelDipilih = document.getElementById("mapel").value;
  const hasil = document.getElementById("hasil");
  hasil.innerHTML = "";

  if (!kode || !mapelDipilih) {
    hasil.innerHTML = "<p>Lengkapi kode dan mata pelajaran</p>";
    return;
  }

  const res = await fetch("data/nilai.csv");
  const text = await res.text();
  const rows = text.trim().split("\n").slice(1);

  let output = "";

  rows.forEach(row => {
    const cols = row.split(";");
    if (cols.length >= 5) {
      const k = cols[0].trim();
      const nama = cols[1].trim();
      const mapelCSV = normalisasiMapel(cols[2]);
      const tanggal = cols[3].trim();
      const nilai = cols[4].trim();

      if (k === kode && mapelCSV === mapelDipilih) {
        output += `
          <div class="card">
            <b>${cols[2]}</b><br>
            Nama: ${nama}<br>
            Tanggal: ${tanggal}<br>
            Nilai: <b>${nilai}</b>
          </div>
        `;
      }
    }
  });

  hasil.innerHTML = output || "<p>Data tidak ditemukan</p>";
}
</script>

</body>
</html>
